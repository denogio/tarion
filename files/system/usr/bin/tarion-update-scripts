#!/usr/bin/env bash
# Update Tarion scripts from system directory
# This allows users to update their local scripts with latest versions

set -euo pipefail

command -v gum &> /dev/null || {
    echo "gum not found, using basic output"
}

TARGET_DIR="${HOME}/.local/bin"
SOURCE_DIR="/usr/lib/tarion-scripts"

gum style --foreground 212 "Updating Tarion scripts..."
echo ""

# Ensure target directory exists
mkdir -p "${TARGET_DIR}"

# Update all scripts
gum spin --spinner dot --title "Updating Tarion scripts..." -- cp -f -r "${SOURCE_DIR}"/* "${TARGET_DIR}/"

# Make them executable
chmod +x "${TARGET_DIR}"/tarion-*

# Show what was updated
UPDATED_COUNT=$(find "${TARGET_DIR}" -maxdepth 1 -name "tarion-*" -type f 2>/dev/null | wc -l)

gum style --foreground 46 "âœ“ Updated ${UPDATED_COUNT} Tarion scripts"

echo ""
gum style --foreground 212 "Tarion utilities updated!"
echo ""
gum style --foreground 244 "Relogin or run: source ~/.bashrc"
